---
title: "Tidy up the data"
subtitle: "From measurements taken by a Walz Diving PAMII"
author: "Sarah Tanja"
date: "`r format(Sys.time(), '%d %B, %Y')`"  
format:
  html:
    df-print: paged
    toc: true
    toc-location: right
    smooth-scroll: true
    link-external-icon: true
    link-external-newwindow: true
    code-fold: false
    code-tools: true
    code-copy: true
    highlight-style: breeze
    code-overflow: wrap
    theme: minty
editor: 
  markdown: 
    wrap: 72
---

# Overview

Quasi dark-adapted rapid light curve analysis from measurements taken by
a Walz Diving PAMII...

# Install and load packages

```{r}
# Install packages
if ("tidyverse" %in% rownames(installed.packages()) == 'FALSE') install.packages('tidyverse')
if ("dplyr" %in% rownames(installed.packages()) == 'FALSE') install.packages('dplyr')
if ("lubridate" %in% rownames(installed.packages()) == 'FALSE') install.packages('lubridate')
if ("stringr" %in% rownames(installed.packages()) == 'FALSE') install.packages('stringr')

# Load packages
library(dplyr)
library(tidyverse)
library(lubridate)
library(stringr)
```


# Pull in data

This data is generated by the report tab in the Win-3 Control Software of the Walz Diving PAM II. Metadata (sample_id, temp, leachate, etc.) were manually entered into the EXCEL workbook generated by Win Control 3. 

```{r}
fvfm_0619 <- read_csv("../pam-data/fvfm_06192024.csv")
fvfm_0620 <- read_csv("../pam-data/fvfm_06202024.csv")
fvfm_0621 <- read_csv("../pam-data/fvfm_06212024.csv")
fvfm_0622 <- read_csv("../pam-data/fvfm_06222024.csv")
```

# Tidy it up

## Day 1 | June 19th 2024
```{r}
fvfm_0619 <- fvfm_0619 %>% 
  filter(!is.na(sample_id)) %>% 
  rename(FvFm = '1:Fv/Fm') %>% 
  rename(Fm = '1:Fm') %>% 
  rename(Fo = '1:Fo') %>% 
  rename(YII = '1:Y (II)') %>% 
  mutate(days_of_exposure = 1) %>% 
  mutate(treatment = str_c(temp, leachate, sep = "_")) %>% 
  mutate(treatment = as.factor(treatment)) %>% 
  select(1,2, 6:16)
```

## Day 2 | June 20th 2024
```{r}
fvfm_0620 <- fvfm_0620 %>% 
  filter(!is.na(sample_id)) %>% 
  rename(FvFm = '1:Fv/Fm') %>% 
  rename(Fm = '1:Fm') %>% 
  rename(Fo = '1:Fo') %>% 
  #rename(YII = '1:Y (II)') %>% 
  mutate(days_of_exposure = 2) %>% 
  mutate(treatment = str_c(temp, leachate, sep = "_")) %>% 
  mutate(treatment = as.factor(treatment)) %>% 
  select(1,2, 6:15)
```

> Hmm okay so I guess Y(II) wasn't selected on all the report exports... but it's literally the exact same as FvFm, and I'm not really sure why that is. But it's the same data... 

## Day 3 | June 21st 2024
```{r}
fvfm_0621 <- fvfm_0621 %>% 
  filter(!is.na(sample_id)) %>% 
  rename(FvFm = '1:Fv/Fm') %>% 
  rename(Fm = '1:Fm') %>% 
  rename(Fo = '1:Fo') %>% 
  #rename(YII = '1:Y (II)') %>% 
  mutate(days_of_exposure = 3) %>% 
  mutate(treatment = str_c(temp, leachate, sep = "_")) %>% 
  mutate(treatment = as.factor(treatment)) %>% 
  select(1,2, 6:15)
```

## Day 4 | June 22nd 2024
```{r}
fvfm_0622 <- fvfm_0622 %>% 
  filter(!is.na(sample_id)) %>% 
  rename(FvFm = '1:Fv/Fm') %>% 
  rename(Fm = '1:Fm') %>% 
  rename(Fo = '1:Fo') %>% 
  #rename(YII = '1:Y (II)') %>% 
  mutate(days_of_exposure = 4) %>% 
  mutate(treatment = str_c(temp, leachate, sep = "_")) %>% 
  mutate(treatment = as.factor(treatment)) %>% 
  select(1,2, 6:15)
```

# Save Fv/Fm dataframes as .csv

```{r}
write.csv(fvfm_0619, file = "../output/fvfm_day1.csv" )
write.csv(fvfm_0620, file = "../output/fvfm_day2.csv" )
write.csv(fvfm_0621, file = "../output/fvfm_day3.csv" )
write.csv(fvfm_0622, file = "../output/fvfm_day4.csv" )
```

::: callout-important
Proceed with analysis of calculated RLC regression variables from Jasby
& Platt (1976) (rERTm, Ik, Alpha) and dark adapted quantum yield (Fv/Fm)
by running two-way anovas and doing initial data visualization in
`02_anovas.qmd`
:::
